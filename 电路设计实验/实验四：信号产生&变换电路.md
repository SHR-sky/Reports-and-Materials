# 实验四：信号产生&变换电路

专业班级：**电信2204**

姓名：        **阮振宇**

学号：        **U202214040**

## 实验名称

信号产生&变换电路设计

## 实验目的

- 掌握方波-三角波信号发生器的设计方法与测量技术
- 掌握滤波器的原理与设计方法
- 利用加法器理解傅里叶变换

## 实验元器件

**_运放：NE5532；_**

**_电阻：1kΩ，10kΩ；_**

**_电位器：100kΩ，50kΩ，1kΩ；_**

**_电容：0.1μF_**

## 实验原理

### 信号发生部分

#### 理论推导

![image-20231126185854118](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231126185854118.png)

​	上图所示电路能自动产生方波-三角波，图中虚线左边是同相输入的**迟滞电压比较器**($A_1$)，其中$C_1$称为加速电容，可加速比较器的翻转；虚线右边是**积分器**($A_2$)


##### a点断开

- 若a点断开，比较器$A_1$的反相端接基准电压，即$V_-$=0，同相端接输入电压$v_{ia}$;比较器输出$v_{o1}$的高电平$V_{OH}$接近于正电源电压＋$V_{CC}$，低电平$V_{OL}$接近于负电源电压﹣$V_{EE}$ （通常|+$V_{CC}$|=|-$V_{EE}$|)。根据叠加原理，得到

$$
V_+=\frac{R_2}{R_2+R_3+R_{P1}}V_{o1}+\frac{R_3+R_{P1}}{R_2+R_3+R_{P1}}V_{ia}
$$

$$
式1
$$

   式中，$R_{P1}$指电位器的调整值（下同）。

- 通常将比较器的输出电压 $v_{oi}$ 从一个电平跳变到另一个电平时对应的输入电压称为门限电压。将比较器翻转时对应的条件 $V_+=V_-=0$代入上式（式1），得到

$$
V_{ia}=\frac{-R_2}{R_3+R_{P1}}V_{o1}
$$

$$
式2
$$

- 设$V_{o1}$=$V_{OH}$=$+V_{CC}$,代入式2得到一个较小值，即比较器翻转的下门限电平

$$
V_{T_-}=V_{ia-}=\frac{-R_2}{R_3+R_{P1}}V_{OH}=\frac{-R_2}{R_3+R_{P1}}V_{CC}
$$

$$
式3
$$

- 设$V_{o1}$=$V_{OL}$=$-V_{EE}$=$-V_{CC}$,代入式2得到一个较大值，即比较器翻转的上门限电平

$$
V_{T_+}=V_{ia+}=\frac{-R_2}{R_3+R_{P1}}V_{OL}=\frac{R_2}{R_3+R_{P1}}V_{CC}
$$

$$
式4
$$

- 比较器的门限宽度或回差电压为

$$
△V_T=V_{T+}-V_{T-}=2×\frac{R_2}{R_3+R_{P1}}V_{CC}
$$

$$
式5
$$

- 比较器的电压传输特性如图所示。当$v_{ia}$为往复跨越上、下门限电平的电压波形时，则$v_{o1}$ 不断在高、低电平之间跳变，**即输出连续方波**。$C_1$在$v_{oi}$跳变瞬间可看作短路，使门限迅速改变，即运放$A_1$的$V_+$和$V_-$和之差迅速增大，从而加速输出的翻转。$C_1$在$V_{o1}$保持高电平或低电平期间则可看作开路。

![image-20231207232506874](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231207232506874.png)

- 运放$A_2$与$R_4$、$R_{p2}$、$R_5$、$C_2$组成反向积分器，若积分器的输入信号$v_{o1}$为方波，则输出电压等于电容两端的电压，即：

$$
v_{o2}=-v_{C_2}=-\frac{1}{C_2}\int\frac{v_{o1}}{R_4+R_{P2}}dt
= -\frac{1}{C_2}\int^{t_1}_{t_0}\frac{v_{o1}}{R_4+R_{P2}}dt-v_{C_2}(t_0)
$$

$$
式6
$$

​		式中，$v_{C2}(t_0)$是$t_0$时刻电容两端的初始电压值，$v_{o2}(t_0)$是$t_0$时刻电路的输出电
​	压，且有$v_{o2}(t_0)$=$-v_{C_2}(t_0)$。

- 当$v_{o1}$=$V_{CC}$时，则

$$
v_{o2}=-\frac{V_{CC}}{(R_4+R_{P2})C_2}(t_1-t_0)+v_{o2}(t_0)
$$

$$
式7
$$

- 当$v_{o1}$=-$V_{CC}$时，则

$$
v_{o2}=\frac{V_{CC}}{(R_4+R_{P2})C_2}(t_1-t_0)+v_{o2}(t_0)
$$

$$
式8
$$

可见，当积分器的输入为方波时，输出是一个下降速率与上升速率相等的三角波，其波形关系如图所示。
![image-20231126184543333](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231126184543333.png)

##### a点闭合

- a 点闭合，即比较器与积分器首尾相连，形成闭环电路，只要积分器的输出电压 $v_{o2}$ 达到比较器的门限电平，使得比较器的输出状态发生改变，则该电路就能自动产生方波﹣三角波。

- 由图所示的波形可知，输出三角波的峰﹣峰值就是比较器的门限宽度，即

$$
V_{o2pp}=△V_T=\frac{2R_2}{R_3+R+{P1}}V_{CC}
$$

$$
式9
$$

- 积分电路的输出电压$v_{o2}$从 $V_{T-}$上升到$V_{T+}$ 所需的时间是振荡周期的一半，即在 $\frac{T}{2}$时间内$v_{o2}$的变化量等于$v_{o2pp}$ 根据式（4.5.8）得到电路的振荡周期为

$$
T=\frac{4R_2(R_4+R_{P2})C_2}{R_3+R_{P1}}
$$

$$
式10
$$

方波-三角波的频率为

$$
f=\frac{1}{4(R_4+R_{P2})C_2}·\frac{R_3+R_{P1}}{R_2}
$$

$$
式11
$$

- 由式9及式11可以得出以下结论：

方波的输出幅度约等于电源电压＋$V_{CC}$ ，三角波的输出幅度与电阻$R_2$与($R_3+R_{P1}$)的比值有关，且小于电源电压＋$V_{CC}$。电位器$R_{P1}$可实现三角波幅度微调，但会影响方波三角波的频率。


电位器$R_{P2}$在调整输出信号的频率时，不会影响三角波输出电压的幅度。因此应先调整电位器 $R_{P1}$，使输出三角波的电压幅值达到所要求的值，然后再调整电位器$R_{P2}$，使输出频率满足要求。若要求输出频率范围较宽，可**取不同的$C_2$来改变频率的范围**，用$R_{P2}$实现频率微调。

#### Multisim仿真

##### 原理图

![image-20231202190353582](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231202190353582.png)



##### 结果

![image-20231202190052798](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231202190052798.png)



### 变换电路部分

#### 整体原理
由傅里叶变换知识可知，对于任意周期信号，均可以分解为正弦信号的叠加。即，看作不同倍频的正弦波通过叠加原理得到。
所以，采取带通滤波器，对信号中某特定频率的信号进行增强，抑制其他频率的信号，则可以得到特定频率的正弦波。
- 该实验，将方波分别通过1次谐波滤波电路、3次谐波滤波电路可以得到$f_{0}和3f_{0}$的正弦波。
- 由相频响应可知，滤波电路存在一定的移相，所以采用相移电路将两正弦波调至同相位。
- 最后，采用加法器，将两同相位正弦波叠加得到近似方波的信号

#### 滤波器原理

滤波器允许一定频率范围内的信号通过，抑制或急剧衰减该频率范围以外的信号。
- 根据要滤波的信号的频率与工作频率的相对关系，滤波器可以分为低通滤波器、高通滤波器、带通滤波器、带阻滤波器和全通滤波器。
- 根据滤波器中是否含有有源器件，可分为有源滤波器和无源滤波器。有源滤波较之无源滤波，能够提高电路带负载能力，同时可以起到放大作用；缺点是，受限于运放带宽限制，有源滤波器的最高工作频率受限。

##### 理论推导

###### 低通滤波器

二阶压控电压源型

![image-20231127205311759](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231127205311759.png)

由同相比例放大器知识，
$$
A_{Vf}=1+\frac{R_{f}}{R_{1}}
$$
对于滤波电路
$$
A_{Vf}=\frac{V_{o}(s)}{V_{p}(s)}，并且V_{p}(s)=\frac{\frac{1}{sC}}{R+\frac{1}{sC}}*V_{A}(s)
$$
$$
\frac{V_{i}(s)-{V_{A}(s)}}{R}-\frac{V_{A}(s)-{V_{o}(s)}}{\frac{1}{sC}}-\frac{V_{A}(s)-{V_{P}(s)}}{R}=0
$$
得滤波电路传递函数
$$
A(s)=\frac{V_{o}(s)}{V_{i}(s)}=\frac{A_{Vf}}{1+(3-A_{Vf})sCR+(sCR)^2}
$$
令$A_{Vf}$称为通带增益，$Q=\frac{1}{3-A_{vf}}$称为等效品质因数，$w_{o}=\frac{1}{RC}$称为特征角频率
注意当 $3-A_{Vf}>0，即A_{Af}<3时，滤波电路才能稳定工作$

代入$s=jw$，即可得到幅频响应
$$
A(jw)=\frac{A_{o}}{1-\left( \frac{w}{w_{o}} \right)^2+j\frac{{1}}{Q}*{\frac{w}{w_{o}}}}=\frac{A_{o}}{1+jQ\left( \frac{w}{w_{o}} -\frac{w_{o}}{w}\right)}
$$

![image-20231128095420212](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231128095420212.png)

则
$$
\mid \frac{A(jw)}{A}\mid=\frac{1}{\sqrt{ 1+\left[ Q\left( \frac{w}{w_{o}}-\frac{w_{o}}{w} \right) \right]^2 }}
$$
以3dB时的频率为截止频率，解得
$$
w_{L}=\frac{w_{o}}{2}\left( \sqrt{ 4+\frac{1}{Q^2} }-\frac{1}{Q} \right)
$$
$$
w_{H}=\frac{w_{o}}{2}\left( \sqrt{ 4+\frac{1}{Q^2} }+\frac{1}{Q} \right)
$$
带宽  $BW=\frac{f_{0}}{Q}$

> 并且，将电阻与电容位置交换，即可以得到高通滤波器


###### 带通滤波器

![image-20231202191655077](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231202191655077.png)

该滤波器可以看作低通、高通两个部分串联而成，并且运放还起到了增益的作用。

传递函数  
$$
A(s) = \frac{A_{vf}sCR}{1+(3-A_{vf})sCR+(sCR)^2}
$$
令$A_{0} = \frac{A_{vf}}{3-A_{vf}},\omega_{0}=\frac{1}{RC},Q=\frac{1}{3-A_{vf}}$  
得  
$$
A(s) = \frac{\frac{A_{0}s}{Q\omega_{0}}}{1+\frac{s}{Q\omega_{0}}+\left( \frac{s}{\omega_{0}} \right)^2}  
$$
则有  
$$
\dot{A}(j\omega)=\frac{A_{0}}{1+jQ\left( \frac{\omega}{\omega_{0}}-\frac{\omega_{0}}{\omega} \right)}  
$$
当$\omega=\omega_{0}$时，有最大值  
$$
\lvert\frac{\dot{A}(j\omega)}{A_{0}}\rvert=1  
$$
传递函数  
$$
A(s) = \frac{A_{vf}sCR}{1+(3-A_{vf})sCR+(sCR)^2}  
$$
令$A_{0} = \frac{A_{vf}}{3-A_{vf}},\omega_{0}=\frac{1}{RC},Q=\frac{1}{3-A_{vf}}$  
得  
$$
A(s) = \frac{\frac{A_{0}s}{Q\omega_{0}}}{1+\frac{s}{Q\omega_{0}}+\left( \frac{s}{\omega_{0}} \right)^2}  
$$
则有  
$$
\dot{A}(j\omega)=\frac{A_{0}\frac{1}{Q}\cdot \frac{j\omega}{\omega_{0}}}{1-\left( \frac{\omega}{\omega_{0}} \right)^2+j\frac{\omega}{Q\omega_{0}}}=\frac{A_{0}}{1+jQ\left( \frac{\omega}{\omega_{0}}-\frac{\omega_{0}}{\omega} \right)}  
$$
当$\omega=\omega_{0}$时，有最大值  
$$
\lvert\frac{\dot{A}(j\omega)}{A_{0}}\rvert=1  
$$
$$
\mid \frac{\dot{A} (j\omega)}{A_{0}}\mid = \frac{1}{\sqrt{ 1+\left[ Q\left( \frac{\omega}{\omega_{0}} - \frac{\omega_{0}}{\omega}\right) \right]^2 }}  
$$
截止角频率  
$$
\omega_{L}=\frac{\omega_{0}}{2}\left( \sqrt{ 4+\frac{1}{Q^2}}-\frac{1}{Q} \right) 
$$
$$
\omega_{H}=\frac{\omega_{0}}{2}\left( \sqrt{ 4+\frac{1}{Q^2}}+\frac{1}{Q} \right)
$$

带宽
$$
BW=\frac{f_{0}}{Q}
$$

实际电路推导过程

取电容C为103，即$10^{-8}F$，由于中心频率为15kHZ，将f代入公式$w_{0}=2\pi f$，联立$w_{0}=\frac{1}{RC}$，解得$R$为1111Ω  ，取标称值1k，则$R_{1}=R_{2}=1kΩ$。
实际搭建电路过程中，由于电容值存在误差，所以电阻$R_{1},R_{f}$取电位器，用于调节电阻值，使得阻容匹配。


###### 全通滤波器

全通滤波器，即移相器，用于调整输入信号的相位。

该图为超前移向，可调相位$0°-180°$，用于将两个信号相位调至相同，便于下一步进入加法器，合成方波信号。
![image-20231127203540518](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231127203540518.png)

## 实验任务

***已知条件：运放NE5532两片***

### 实验要求

1. 产生频率为5kHz，峰峰值为10V的方波，再由方波生成对应频率，峰峰值为6V的三角波

2. 设计信号分解、合成（选做）电路：对所产生的方波进行滤波分解，产生该方波的一次、三次谐波正弦信号，再将这些信号合成为近似方波的信号


## 实验结果

### 方波、三角波产生

![IMG_20231202_195234](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/IMG_20231202_195234.jpg)


### 滤波部分

#### 一阶

![IMG_20231202_195304](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/IMG_20231202_195304.jpg)


#### 三阶

![image-20231204213536038](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231204213536038.png)


#### 移相加法

![IMG_20231204_211654](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/IMG_20231204_211654.jpg)


单独以合成波为触发信源，得到的合成波

![image-20231207230153256](https://cdn.jsdelivr.net/gh/SHR-sky/Picture@main/Pic/image-20231207230153256.png)


## 总结

通过两周的调试后，完成了信号发生以及处理电路。除了复习了之前用到的积分电路，还学习了滤波电路。掌握了传递函数的列写、运用方法。能够从理论上，对一个有源网络进行分析，并且得到一系列指标参数。

能够构建有源滤波网络。并且深刻认识到理论计算和实际的差距。熟悉了采用电位器调整电路参数，达到最佳效果的方法。

在电路设计实验即将结束的时候，回看过去的四次实验，感觉通过自己亲手构建电路，对知识的掌握更加深刻了。非常感谢实验中，老师对理论知识的复习，以及对理论到实际转化的指导。
